@model IEnumerable<AzureBlog.Models.ArticleModel>

@{
    ViewBag.Title = "Article";
}
<div class="wholePost">
    @foreach (var article in Model)
    {
        <img class="coverPic" src="@article.ArticlePic" />
        <div class="greyBox">
            <div class="alignCenter">
                <p class="tblContents">Table of contents</p>
            </div>
            <hr />
            @Html.Partial("_tableOfContents", article)
        </div>
        foreach (var segment in article.ArticleSegments.OrderByDescending(x => x.Votes))
        {
            <div class="greyBox">
                <form class="upvote" action="~/Default/Article/Upvote">
                    <input name="segId" hidden value="@segment.ArticleSegmentId" />
                    <input name="artSlug" hidden value="@article.ArticleSlug" />
          
                    <button id="heart">
                        @segment.Votes
                    </button>
                </form>

                <p id="@segment.ArticleSegmentTitle" class="segTitle"> @segment.ArticleSegmentTitle</p>

                @if (segment.ArticleSegmentVideo != null && segment.ArticleSegmentVideo != "Optional Video")
                {
                    <iframe class="segmentVideo" src="https://www.youtube.com/embed/@segment.ArticleSegmentVideo" frameborder="0" allowfullscreen></iframe>
                }
      
                

                <p class="bodyText">
                 @segment.ArticleSegmentPar1
                </p>
                <p class="bodyText">
                    @segment.ArticleSegmentPar2
                </p>
                <p class="bodyText">
                    @segment.ArticleSegmentPar3
                </p>

                @if (segment.ArticleSegmentAuthor != null && segment.ArticleSegmentWebsite != null)
                {
                    <a href="@segment.ArticleSegmentWebsite">-@segment.ArticleSegmentAuthor</a>
                }
                else if (segment.ArticleSegmentAuthor != null)
                {
                    <p>-@segment.ArticleSegmentAuthor</p>
                }



                @Html.Partial("_firstProduct", segment)
                @Html.Partial("_productList", segment)

            </div>

            if (User.IsInRole("Admin"))
            {
                <h1>Add product</h1>
                <form action="~/Default/Article/AddProduct">
                    <input name="segId" hidden value="@segment.ArticleSegmentId" />
                    <input name="artSlug" hidden value="@article.ArticleSlug" />
                    <hr />
                    <input name="ASIN" placeholder="ASIN" />
                    <hr />
                    <button>Add Product</button>
                </form>
                <hr />
                <form action="~/Default/Article/DeleteSegment">
                    <input name="segId" hidden value="@segment.ArticleSegmentId" />
                    <input name="ArticleSlug" hidden value="@article.ArticleSlug" />
                    <button>Delete</button>
                </form>
            }


        }
        @Html.Partial("_addSegment", article);
        @Html.Partial("_userAddSegment", article);
    }

</div>